2025-05-02 17:52:56.664 | INFO     | datatrove.utils.logging:add_task_logger:58 - Launching pipeline for rank=0
2025-05-02 17:52:56.666 | INFO     | datatrove.utils.logging:log_pipeline:90 - 
--- 🛠️ PIPELINE 🛠
📖 - READER: 🐿 Jsonl
🔻 - FILTER: 🌍 Language ID
None: None
💽 - WRITER: 🐿 Jsonl
2025-05-02 17:52:56.736 | INFO     | datatrove.pipeline.readers.base:read_files_shard:201 - Reading input file cleaned_documents.jsonl, 1/2
2025-05-02 17:52:59.212 | ERROR    | datatrove.executor.base:_run_for_rank:108 - Object of type Document is not JSON serializable
Traceback (most recent call last):

  File "/Users/adrienloizeau/dev/scratchgpt/datasets/fineweb_processing.py", line 46, in <module>
    executor.run()
    │        └ <function LocalPipelineExecutor.run at 0x1279db0a0>
    └ <datatrove.executor.local.LocalPipelineExecutor object at 0x1279f0b80>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 127, in run
    stats.append(self._launch_run_for_rank(rank, ranks_q))
    │     │      │    │                    │     └ <AutoProxy[Queue] object, typeid 'Queue' at 0x1279f0940>
    │     │      │    │                    └ 0
    │     │      │    └ <function LocalPipelineExecutor._launch_run_for_rank at 0x1279db010>
    │     │      └ <datatrove.executor.local.LocalPipelineExecutor object at 0x1279f0b80>
    │     └ <method 'append' of 'list' objects>
    └ []
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 76, in _launch_run_for_rank
    return self._run_for_rank(rank, local_rank)
           │    │             │     └ 0
           │    │             └ 0
           │    └ <function PipelineExecutor._run_for_rank at 0x1279dac20>
           └ <datatrove.executor.local.LocalPipelineExecutor object at 0x1279f0b80>
> File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/base.py", line 96, in _run_for_rank
    deque(pipelined_data, maxlen=0)
    │     └ <generator object DiskWriter.run at 0x12798b0d0>
    └ <class 'collections.deque'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/writers/disk_base.py", line 178, in run
    for document in data:
                    └ <generator object SizeLimiter.run at 0x12798b6f0>

  File "/Users/adrienloizeau/dev/scratchgpt/datasets/fineweb_processing.py", line 20, in run
    document_size = len(json.dumps(document).encode("utf-8"))
                        │    │     └ Document(text="What are the license/legal requirements to write a guidebook about a specific product?\nAs the title says. I'm...
                        │    └ <function dumps at 0x1103539a0>
                        └ <module 'json' from '/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/json/__init__.py'>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ Document(text="What are the license/legal requirements to write a guidebook about a specific product?\nAs the title says. I'm...
           │                └ <function JSONEncoder.encode at 0x110353d00>
           └ <json.encoder.JSONEncoder object at 0x1102b7a30>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ Document(text="What are the license/legal requirements to write a guidebook about a specific product?\nAs the title says. I'm...
             │    └ <function JSONEncoder.iterencode at 0x110353d90>
             └ <json.encoder.JSONEncoder object at 0x1102b7a30>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
           │           └ Document(text="What are the license/legal requirements to write a guidebook about a specific product?\nAs the title says. I'm...
           └ <_json.Encoder object at 0x127a4a380>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Document is not JSON serializable
