2025-05-02 12:43:05.825 | INFO     | datatrove.utils.logging:add_task_logger:58 - Launching pipeline for rank=0
2025-05-02 12:43:05.826 | INFO     | datatrove.utils.logging:log_pipeline:90 - 
--- ğŸ› ï¸ PIPELINE ğŸ› 
ğŸ“– - READER: ğŸ¿ Jsonl
None: None
None: None
ğŸ”» - FILTER: ğŸŒ Language ID
ğŸ’½ - WRITER: ğŸ¿ Jsonl
2025-05-02 12:43:05.963 | INFO     | datatrove.pipeline.readers.base:read_files_shard:201 - Reading input file {"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound amplification?", "body": "I'm trying to comfortably use my laptop at night and now could not find an answer by web-search to the following: Why TVs / laptops etc. do not warn about too bright screen whereas many smartphones warn about too loud sound amplification? I'm asking on law site cause I suspect there were a number of successful lawsuits for impaired hearing from headphones but none for impaired vision from TVs. Am I right here? Digging down - has it happened because there are studies proving impairment for one and none for the other?\n\n\nAdded: I actually doubt my second guess cause there are a lot of enhancements in screen brightness - auto-brightness, night mode.\n\n\n", "score": 0, "source": "law_stack_exchange"}, 1/2553
2025-05-02 12:43:06.163 | ERROR    | datatrove.executor.base:_run_for_rank:108 - [Errno 2] No such file or directory: '/Users/adrienloizeau/dev/scratchGPT/data/raw/{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound amplification?", "body": "I\'m trying to comfortably use my laptop at night and now could not find an answer by web-search to the following: Why TVs / laptops etc. do not warn about too bright screen whereas many smartphones warn about too loud sound amplification? I\'m asking on law site cause I suspect there were a number of successful lawsuits for impaired hearing from headphones but none for impaired vision from TVs. Am I right here? Digging down - has it happened because there are studies proving impairment for one and none for the other?\\n\\n\\nAdded: I actually doubt my second guess cause there are a lot of enhancements in screen brightness - auto-brightness, night mode.\\n\\n\\n", "score": 0, "source": "law_stack_exchange"}'
Traceback (most recent call last):

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 77, in <module>
    executor.run()
    â”‚        â”” <function LocalPipelineExecutor.run at 0x123d520e0>
    â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x12582d8d0>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 127, in run
    stats.append(self._launch_run_for_rank(rank, ranks_q))
    â”‚     â”‚      â”‚    â”‚                    â”‚     â”” <AutoProxy[Queue] object, typeid 'Queue' at 0x12582f160>
    â”‚     â”‚      â”‚    â”‚                    â”” 0
    â”‚     â”‚      â”‚    â”” <function LocalPipelineExecutor._launch_run_for_rank at 0x123d52050>
    â”‚     â”‚      â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x12582d8d0>
    â”‚     â”” <method 'append' of 'list' objects>
    â”” []
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 76, in _launch_run_for_rank
    return self._run_for_rank(rank, local_rank)
           â”‚    â”‚             â”‚     â”” 0
           â”‚    â”‚             â”” 0
           â”‚    â”” <function PipelineExecutor._run_for_rank at 0x123d51c60>
           â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x12582d8d0>
> File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/base.py", line 96, in _run_for_rank
    deque(pipelined_data, maxlen=0)
    â”‚     â”” <generator object DiskWriter.run at 0x128460580>
    â”” <class 'collections.deque'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/writers/disk_base.py", line 178, in run
    for document in data:
                    â”” <generator object BaseFilter.run at 0x1284603c0>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/filters/base_filter.py", line 64, in run
    for batch in batched(data, self.batch_size):
                 â”‚       â”‚     â”‚    â”” 1
                 â”‚       â”‚     â”” ğŸ”» - FILTER: ğŸŒ Language ID
                 â”‚       â”” <generator object ScoreFilter.run at 0x1284600b0>
                 â”” <function batched at 0x123a001f0>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/utils/batching.py", line 20, in batched
    while batch := list(itertools.islice(it, n)):
                        â”‚         â”‚      â”‚   â”” 1
                        â”‚         â”‚      â”” <generator object ScoreFilter.run at 0x1284600b0>
                        â”‚         â”” <class 'itertools.islice'>
                        â”” <module 'itertools' (built-in)>

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 42, in run
    for document in data:
        â”‚           â”” <generator object MergeFields.run at 0x128460660>
        â”” {'title': 'How to establish first use in commerce?', 'body': "I recently learned that it's not the first person to register a...

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 33, in run
    for document in data:
        â”‚           â”” <generator object BaseDiskReader.run at 0x128460890>
        â”” {'title': 'How to establish first use in commerce?', 'body': "I recently learned that it's not the first person to register a...

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/base.py", line 245, in run
    for doc in self.read_files_shard(files_shard):
               â”‚    â”‚                â”” ['{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound a...
               â”‚    â”” <function BaseDiskReader.read_files_shard at 0x1239eb2e0>
               â”” ğŸ“– - READER: ğŸ¿ Jsonl
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/base.py", line 204, in read_files_shard
    for di, document in enumerate(self.read_file(filepath)):
        â”‚                         â”‚    â”‚         â”” '{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound am...
        â”‚                         â”‚    â”” <function JsonlReader.read_file at 0x1239ebb50>
        â”‚                         â”” ğŸ“– - READER: ğŸ¿ Jsonl
        â”” 0
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/jsonl.py", line 73, in read_file
    with self.data_folder.open(filepath, "r", compression=self.compression) as f:
         â”‚    â”‚           â”‚    â”‚                          â”‚    â”” None
         â”‚    â”‚           â”‚    â”‚                          â”” ğŸ“– - READER: ğŸ¿ Jsonl
         â”‚    â”‚           â”‚    â”” '{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound am...
         â”‚    â”‚           â”” <function DataFolder.open at 0x1239b9e10>
         â”‚    â”” DataFolder(path='/Users/adrienloizeau/dev/scratchGPT/data/raw', fs=<fsspec.implementations.local.LocalFileSystem object at 0x...
         â”” ğŸ“– - READER: ğŸ¿ Jsonl
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/io.py", line 236, in open
    return super().open(path, mode=mode, *args, **kwargs)
                        â”‚          â”‚      â”‚       â”” {'compression': None}
                        â”‚          â”‚      â”” ()
                        â”‚          â”” 'r'
                        â”” '{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound am...
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/dirfs.py", line 368, in open
    return self.fs.open(
           â”‚    â”‚  â”” <function AbstractFileSystem.open at 0x10cc65240>
           â”‚    â”” <fsspec.implementations.local.LocalFileSystem object at 0x123d5f6d0>
           â”” DataFolder(path='/Users/adrienloizeau/dev/scratchGPT/data/raw', fs=<fsspec.implementations.local.LocalFileSystem object at 0x...
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/spec.py", line 1298, in open
    self.open(
    â”‚    â”” <function AbstractFileSystem.open at 0x10cc65240>
    â”” <fsspec.implementations.local.LocalFileSystem object at 0x123d5f6d0>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/spec.py", line 1310, in open
    f = self._open(
        â”‚    â”” <function LocalFileSystem._open at 0x12328b880>
        â”” <fsspec.implementations.local.LocalFileSystem object at 0x123d5f6d0>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 200, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
           â”‚               â”‚     â”‚        â”‚       â”” {'autocommit': True, 'cache_options': None}
           â”‚               â”‚     â”‚        â”” <fsspec.implementations.local.LocalFileSystem object at 0x123d5f6d0>
           â”‚               â”‚     â”” 'rb'
           â”‚               â”” '/Users/adrienloizeau/dev/scratchGPT/data/raw/{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas ...
           â”” <class 'fsspec.implementations.local.LocalFileOpener'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 364, in __init__
    self._open()
    â”‚    â”” <function LocalFileOpener._open at 0x12328beb0>
    â”” <fsspec.implementations.local.LocalFileOpener object at 0x123d5f190>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 369, in _open
    self.f = open(self.path, mode=self.mode)
    â”‚    â”‚        â”‚    â”‚          â”‚    â”” 'rb'
    â”‚    â”‚        â”‚    â”‚          â”” <fsspec.implementations.local.LocalFileOpener object at 0x123d5f190>
    â”‚    â”‚        â”‚    â”” '/Users/adrienloizeau/dev/scratchGPT/data/raw/{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas ...
    â”‚    â”‚        â”” <fsspec.implementations.local.LocalFileOpener object at 0x123d5f190>
    â”‚    â”” None
    â”” <fsspec.implementations.local.LocalFileOpener object at 0x123d5f190>

FileNotFoundError: [Errno 2] No such file or directory: '/Users/adrienloizeau/dev/scratchGPT/data/raw/{"title": "Why TVs / laptops etc. do not warn about too brirght screen whereas many smartphones warn about too loud sound amplification?", "body": "I\'m trying to comfortably use my laptop at night and now could not find an answer by web-search to the following: Why TVs / laptops etc. do not warn about too bright screen whereas many smartphones warn about too loud sound amplification? I\'m asking on law site cause I suspect there were a number of successful lawsuits for impaired hearing from headphones but none for impaired vision from TVs. Am I right here? Digging down - has it happened because there are studies proving impairment for one and none for the other?\\n\\n\\nAdded: I actually doubt my second guess cause there are a lot of enhancements in screen brightness - auto-brightness, night mode.\\n\\n\\n", "score": 0, "source": "law_stack_exchange"}'
