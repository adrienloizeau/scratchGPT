2025-05-02 18:11:36.304 | INFO     | datatrove.utils.logging:add_task_logger:58 - Launching pipeline for rank=0
2025-05-02 18:11:36.342 | INFO     | datatrove.utils.logging:log_pipeline:90 - 
--- 🛠️ PIPELINE 🛠
📖 - READER: 🐿 Jsonl
None: None
🔻 - FILTER: 🌍 Language ID
💽 - WRITER: 🐿 Jsonl
2025-05-02 18:11:36.851 | INFO     | datatrove.pipeline.readers.base:read_files_shard:201 - Reading input file {"text": "\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were going numb, I was also really mad because with the horrible cell reception I had my phone never rang when he called, he just went to voicemail. I do love voicemails, but I hate missing calls more. I have only missed one.\nHe said we had an unspoken contest going with grammar and punctuation. This was my first slip up, and I don\u2019t judge his. I always proof read before I send things to him, he usually does the same.\nThis goes to show we are made for each other. We are such weirdos.\n\u201cIn a relationship you have to accept the other person for all of who they are and not just the parts that are easy to like. And your stupid if you turn your back on something as important as LOVE. When you love someone, you love all of them; not just the good parts, but the bad ones too.\u201d\u2014Valentine\u2019s Day movie (via devilscake)", "id": "<urn:uuid:9dd5e82f-7b21-47be-9cbc-210388fa902c>", "dump": "CC-MAIN-2013-48", "url": "http://1000timesbefore.tumblr.com/archive/2011/1", "date": "2013-12-04T16:05:16Z", "file_path": "s3://commoncrawl/crawl-data/CC-MAIN-2013-48/segments/1386163035819/warc/CC-MAIN-20131204131715-00000-ip-10-33-133-15.ec2.internal.warc.gz", "language": "en", "language_score": 0.9832355976104736, "token_count": 231}, 1/10000
2025-05-02 18:11:36.933 | ERROR    | datatrove.executor.base:_run_for_rank:108 - [Errno 63] File name too long: '/Users/adrienloizeau/dev/scratchGPT/data/{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were going numb, I was also really mad because with the horrible cell reception I had my phone never rang when he called, he just went to voicemail. I do love voicemails, but I hate missing calls more. I have only missed one.\\nHe said we had an unspoken contest going with grammar and punctuation. This was my first slip up, and I don\\u2019t judge his. I always proof read before I send things to him, he usually does the same.\\nThis goes to show we are made for each other. We are such weirdos.\\n\\u201cIn a relationship you have to accept the other person for all of who they are and not just the parts that are easy to like. And your stupid if you turn your back on something as important as LOVE. When you love someone, you love all of them; not just the good parts, but the bad ones too.\\u201d\\u2014Valentine\\u2019s Day movie (via devilscake)", "id": "<urn:uuid:9dd5e82f-7b21-47be-9cbc-210388fa902c>", "dump": "CC-MAIN-2013-48", "url": "http://1000timesbefore.tumblr.com/archive/2011/1", "date": "2013-12-04T16:05:16Z", "file_path": "s3://commoncrawl/crawl-data/CC-MAIN-2013-48/segments/1386163035819/warc/CC-MAIN-20131204131715-00000-ip-10-33-133-15.ec2.internal.warc.gz", "language": "en", "language_score": 0.9832355976104736, "token_count": 231}'
Traceback (most recent call last):

  File "/Users/adrienloizeau/dev/scratchGPT/data_processing.py", line 75, in <module>
    executor.run()
    │        └ <function LocalPipelineExecutor.run at 0x11f1fb0a0>
    └ <datatrove.executor.local.LocalPipelineExecutor object at 0x12242ad40>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 127, in run
    stats.append(self._launch_run_for_rank(rank, ranks_q))
    │     │      │    │                    │     └ <AutoProxy[Queue] object, typeid 'Queue' at 0x12242be50>
    │     │      │    │                    └ 0
    │     │      │    └ <function LocalPipelineExecutor._launch_run_for_rank at 0x11f1fb010>
    │     │      └ <datatrove.executor.local.LocalPipelineExecutor object at 0x12242ad40>
    │     └ <method 'append' of 'list' objects>
    └ []
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 76, in _launch_run_for_rank
    return self._run_for_rank(rank, local_rank)
           │    │             │     └ 0
           │    │             └ 0
           │    └ <function PipelineExecutor._run_for_rank at 0x11f1fac20>
           └ <datatrove.executor.local.LocalPipelineExecutor object at 0x12242ad40>
> File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/base.py", line 96, in _run_for_rank
    deque(pipelined_data, maxlen=0)
    │     └ <generator object DiskWriter.run at 0x1245a3ae0>
    └ <class 'collections.deque'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/writers/disk_base.py", line 178, in run
    for document in data:
                    └ <generator object BaseFilter.run at 0x1245a3c30>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/filters/base_filter.py", line 64, in run
    for batch in batched(data, self.batch_size):
                 │       │     │    └ 1
                 │       │     └ 🔻 - FILTER: 🌍 Language ID
                 │       └ <generator object ScoreFilter.run at 0x11f0275a0>
                 └ <function batched at 0x11f0cc160>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/utils/batching.py", line 20, in batched
    while batch := list(itertools.islice(it, n)):
                        │         │      │   └ 1
                        │         │      └ <generator object ScoreFilter.run at 0x11f0275a0>
                        │         └ <class 'itertools.islice'>
                        └ <module 'itertools' (built-in)>

  File "/Users/adrienloizeau/dev/scratchGPT/data_processing.py", line 40, in run
    for document in data:
                    └ <generator object BaseDiskReader.run at 0x12450d0e0>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/base.py", line 245, in run
    for doc in self.read_files_shard(files_shard):
               │    │                └ ['{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were ...
               │    └ <function BaseDiskReader.read_files_shard at 0x11f0b7250>
               └ 📖 - READER: 🐿 Jsonl
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/base.py", line 204, in read_files_shard
    for di, document in enumerate(self.read_file(filepath)):
        │                         │    │         └ '{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were g...
        │                         │    └ <function JsonlReader.read_file at 0x11f0b7ac0>
        │                         └ 📖 - READER: 🐿 Jsonl
        └ 0
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/readers/jsonl.py", line 73, in read_file
    with self.data_folder.open(filepath, "r", compression=self.compression) as f:
         │    │           │    │                          │    └ 'infer'
         │    │           │    │                          └ 📖 - READER: 🐿 Jsonl
         │    │           │    └ '{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were g...
         │    │           └ <function DataFolder.open at 0x11f07dd80>
         │    └ DataFolder(path='/Users/adrienloizeau/dev/scratchGPT/data', fs=<fsspec.implementations.local.LocalFileSystem object at 0x107b...
         └ 📖 - READER: 🐿 Jsonl
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/io.py", line 236, in open
    return super().open(path, mode=mode, *args, **kwargs)
                        │          │      │       └ {'compression': 'infer'}
                        │          │      └ ()
                        │          └ 'r'
                        └ '{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were g...
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/dirfs.py", line 368, in open
    return self.fs.open(
           │    │  └ <function AbstractFileSystem.open at 0x1083691b0>
           │    └ <fsspec.implementations.local.LocalFileSystem object at 0x107b0ac50>
           └ DataFolder(path='/Users/adrienloizeau/dev/scratchGPT/data', fs=<fsspec.implementations.local.LocalFileSystem object at 0x107b...
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/spec.py", line 1298, in open
    self.open(
    │    └ <function AbstractFileSystem.open at 0x1083691b0>
    └ <fsspec.implementations.local.LocalFileSystem object at 0x107b0ac50>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/spec.py", line 1310, in open
    f = self._open(
        │    └ <function LocalFileSystem._open at 0x11e8f77f0>
        └ <fsspec.implementations.local.LocalFileSystem object at 0x107b0ac50>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 200, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
           │               │     │        │       └ {'autocommit': True, 'cache_options': None}
           │               │     │        └ <fsspec.implementations.local.LocalFileSystem object at 0x107b0ac50>
           │               │     └ 'rb'
           │               └ '/Users/adrienloizeau/dev/scratchGPT/data/{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on...
           └ <class 'fsspec.implementations.local.LocalFileOpener'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 364, in __init__
    self._open()
    │    └ <function LocalFileOpener._open at 0x11e8f7e20>
    └ <fsspec.implementations.local.LocalFileOpener object at 0x1293842b0>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/fsspec/implementations/local.py", line 369, in _open
    self.f = open(self.path, mode=self.mode)
    │    │        │    │          │    └ 'rb'
    │    │        │    │          └ <fsspec.implementations.local.LocalFileOpener object at 0x1293842b0>
    │    │        │    └ '/Users/adrienloizeau/dev/scratchGPT/data/{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on...
    │    │        └ <fsspec.implementations.local.LocalFileOpener object at 0x1293842b0>
    │    └ None
    └ <fsspec.implementations.local.LocalFileOpener object at 0x1293842b0>

OSError: [Errno 63] File name too long: '/Users/adrienloizeau/dev/scratchGPT/data/{"text": "\\u2026. in an email I sent to my dear I forgot two commas. I typed it on my phone in the cold and my hands were going numb, I was also really mad because with the horrible cell reception I had my phone never rang when he called, he just went to voicemail. I do love voicemails, but I hate missing calls more. I have only missed one.\\nHe said we had an unspoken contest going with grammar and punctuation. This was my first slip up, and I don\\u2019t judge his. I always proof read before I send things to him, he usually does the same.\\nThis goes to show we are made for each other. We are such weirdos.\\n\\u201cIn a relationship you have to accept the other person for all of who they are and not just the parts that are easy to like. And your stupid if you turn your back on something as important as LOVE. When you love someone, you love all of them; not just the good parts, but the bad ones too.\\u201d\\u2014Valentine\\u2019s Day movie (via devilscake)", "id": "<urn:uuid:9dd5e82f-7b21-47be-9cbc-210388fa902c>", "dump": "CC-MAIN-2013-48", "url": "http://1000timesbefore.tumblr.com/archive/2011/1", "date": "2013-12-04T16:05:16Z", "file_path": "s3://commoncrawl/crawl-data/CC-MAIN-2013-48/segments/1386163035819/warc/CC-MAIN-20131204131715-00000-ip-10-33-133-15.ec2.internal.warc.gz", "language": "en", "language_score": 0.9832355976104736, "token_count": 231}'
