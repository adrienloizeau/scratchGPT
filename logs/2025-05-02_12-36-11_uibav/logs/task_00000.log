2025-05-02 12:36:11.752 | INFO     | datatrove.utils.logging:add_task_logger:58 - Launching pipeline for rank=0
2025-05-02 12:36:11.753 | INFO     | datatrove.utils.logging:log_pipeline:90 - 
--- ğŸ› ï¸ PIPELINE ğŸ› 
ğŸ“– - READER: ğŸ¿ Jsonl
None: None
None: None
ğŸ”» - FILTER: ğŸŒ Language ID
ğŸ’½ - WRITER: ğŸ¿ Jsonl
2025-05-02 12:36:11.755 | INFO     | datatrove.pipeline.readers.base:read_files_shard:201 - Reading input file cleaned_documents.jsonl, 1/2
2025-05-02 12:36:11.787 | ERROR    | datatrove.executor.base:_run_for_rank:108 - 'Document' object is not subscriptable
Traceback (most recent call last):

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 64, in <module>
    executor.run()
    â”‚        â”” <function LocalPipelineExecutor.run at 0x122f1a050>
    â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x122f26860>

  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 127, in run
    stats.append(self._launch_run_for_rank(rank, ranks_q))
    â”‚     â”‚      â”‚    â”‚                    â”‚     â”” <AutoProxy[Queue] object, typeid 'Queue' at 0x124a50580>
    â”‚     â”‚      â”‚    â”‚                    â”” 0
    â”‚     â”‚      â”‚    â”” <function LocalPipelineExecutor._launch_run_for_rank at 0x122f19fc0>
    â”‚     â”‚      â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x122f26860>
    â”‚     â”” <method 'append' of 'list' objects>
    â”” []
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/local.py", line 76, in _launch_run_for_rank
    return self._run_for_rank(rank, local_rank)
           â”‚    â”‚             â”‚     â”” 0
           â”‚    â”‚             â”” 0
           â”‚    â”” <function PipelineExecutor._run_for_rank at 0x122f19bd0>
           â”” <datatrove.executor.local.LocalPipelineExecutor object at 0x122f26860>
> File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/executor/base.py", line 96, in _run_for_rank
    deque(pipelined_data, maxlen=0)
    â”‚     â”” <generator object DiskWriter.run at 0x124eac7b0>
    â”” <class 'collections.deque'>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/writers/disk_base.py", line 178, in run
    for document in data:
                    â”” <generator object BaseFilter.run at 0x124eac660>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/pipeline/filters/base_filter.py", line 64, in run
    for batch in batched(data, self.batch_size):
                 â”‚       â”‚     â”‚    â”” 1
                 â”‚       â”‚     â”” ğŸ”» - FILTER: ğŸŒ Language ID
                 â”‚       â”” <generator object ScoreFilter.run at 0x124eac3c0>
                 â”” <function batched at 0x122bc4160>
  File "/Users/adrienloizeau/opt/anaconda3/envs/lerobot/lib/python3.10/site-packages/datatrove/utils/batching.py", line 20, in batched
    while batch := list(itertools.islice(it, n)):
                        â”‚         â”‚      â”‚   â”” 1
                        â”‚         â”‚      â”” <generator object ScoreFilter.run at 0x124eac3c0>
                        â”‚         â”” <class 'itertools.islice'>
                        â”” <module 'itertools' (built-in)>

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 42, in run
    for document in data:
                    â”” <generator object MergeFields.run at 0x124eac040>

  File "/Users/adrienloizeau/dev/scratchGPT/data_pipeline.py", line 34, in run
    document["text"] = f"{document['title']}\n{document['body']}"
    â”” Document(text="What are the license/legal requirements to write a guidebook about a specific product?\nAs the title says. I'm...

TypeError: 'Document' object is not subscriptable
